String.prototype.format=function(a){return this.replace(/{{([^{}]+)}}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:"N/A"})};var currentMousePos={x:-1,y:-1};$(document).on("mousemove",function(a){currentMousePos.x=a.pageX;currentMousePos.y=a.pageY});currentMousePos.offset=function(a){return{x:this.x-$("#"+a).offset().left,y:this.y-$("#"+a).offset().top}};function fnLighten(a,b){a=Raphael.getRGB(a);return"rgb("+((1-b)*a.r+255*b)+","+((1-b)*a.g+255*b)+","+((1-b)*a.b+255*b)+")"}
function fnPiece(a){var b,c,d=[];b=this instanceof RaphaGraph?this:this.o.rg;a.params.cursor="pointer";a.data.color=a.params.fill;a.data.group=this.o.title||b.o.names.group[this.o.index];a.rPiece?c=a.rPiece:(c=b.o.paper.path(b.o.animate&&a.sPath0?a.sPath0:a.sPath).attr(a.params),c.hover(b.o.fnHoverIn,b.o.fnHoverOut).click(b.o.fnClick),a.data.aBacks=a.aBacks.slice(0));if(b.o.animate){b=a.aAnimations||this.aAnimations;var e;a.sPath0?e={path:a.sPath}:(c.attr({transform:"s0"}),e={transform:"s1"});b.push({elem:c,
attr:e})}if(a.rPiece)for(b=0;b<c.items.length;b++)d.push(c.items[b].id);else c.id=Raphael.createUUID(),d.push(c.id);for(b=0;b<d.length;b++)a.aBacks.unshift(d[b]);for(var f in a.data)c.data(f,a.data[f]);c.oG=this;this.rData.push(c);return c}function Doll(a,b,c,d){a-=c/2;var e=Math.min(c/10,d),f=a+c,h=b-d+e;d=b-d;return"M"+a+" "+b+"L"+a+" "+h+"Q"+a+" "+d+" "+(a+e)+" "+d+"L"+(a+c-e)+" "+d+"Q"+f+" "+d+" "+f+" "+h+"L"+f+" "+b+"L"+a+" "+b+"Z"}
function Rect(a,b,c,d){c=a+c;d=b+d;return"M"+a+" "+b+"L"+a+" "+d+"L"+c+" "+d+"L"+c+" "+b+"L"+a+" "+b+"Z"}function fnDonut(a,b,c,d){return"M"+a+" "+(b-d)+"a"+d+" "+d+" 0 1 0 1 0m-1 "+(d-c)+"a"+c+" "+c+" 0 1 1 -1 0"}
function fnWedge(a,b,c,d,e){var f=Math.PI/180,h=a+c*Math.sin(d*f),g=a+c*Math.sin(e*f),k=b-c*Math.cos(d*f),f=b-c*Math.cos(e*f);return 360==e-d?"M {{cx}}, {{cy}} m -{{r}}, 0 a {{r}},{{r}} 0 1,0 {{2r}},0 a {{r}},{{r}} 0 1,0 -{{2r}},0".format({cx:a,cy:b,r:c,"2r":2*c}):["M",a,b,"L",h,k,"A",c,c,0,180>e-d?0:1,1,g,f,"Z"]}
function fnCrust(a,b,c,d,e,f){var h=Math.PI/180,g=d-c,k=a+c*Math.sin(e*h),q=k+g*Math.sin(e*h),n=a+c*Math.sin(f*h),r=n+g*Math.sin(f*h),l=b-c*Math.cos(e*h),m=l-g*Math.cos(e*h),p=b-c*Math.cos(f*h),h=p-g*Math.cos(f*h),g=180>f-e?0:1;return 360==f-e?fnDonut(a,b,c,d):["M",k,l,"L",q,m,"A",d,d,0,g,1,r,h,"L",n,p,"A",c,c,0,g,0,k,l,"Z"]}
function gradStrip(a){function b(){f.mouseIn||(a.paper.rg.o.fnHoverIn.call(f),d.toFront(),e.toFront(),f.toFront(),f.rBox.toFront())}function c(){a.paper.rg.o.fnHoverOut.call(f)}var d=a.paper.path(Rect(a.x-a.w/2,a.y-a.h1,a.w,a.h1)).attr({fill:a.color,"stroke-width":0,"stroke-opacity":0}),e=a.paper.path(Doll(a.x,a.y-a.h1,a.w,a.h2-a.h1)).attr({fill:"90-"+a.color+"-#FFF","stroke-width":0,"stroke-opacity":0}),f=a.paper.path(Doll(a.x,a.y,a.w,a.h2)).attr({stroke:"#000",opacity:1}),h=a.paper.set();d.hover(b,
c);e.hover(b,c);f.hover(b,c).click(a.paper.rg.o.fnClick);d.id=Raphael.createUUID();e.id=Raphael.createUUID();f.id=Raphael.createUUID();a.aBacks.unshift(d.id);a.aBacks.unshift(e.id);f.data("aBacks",a.aBacks.slice(0));a.aBacks.unshift(f.id);h.push(d,e,f);return h}
function fnTotal(){var a=this,b=a.o.rg;a.total=0;a.catTotals=[];a.fnIter({a:a.o.aData,scope:"cat",fn1:function(c,d,e){if(0>a.oExcludes.cat.indexOf(e)){var f=0;a.fnIter({a:c,scope:"var",fn1:tooFar,fn2:function(c,e,k){b.o.additive?0>a.oExcludes["var"].indexOf(k)&&(a.total+=c,f+=c):a instanceof BarGroup?(b.min=Math.min(c,b.min),b.max=Math.max(c,b.max)):0==e?(a.total+=c,a.catTotals.push(c)):!a.TOTAL&&a instanceof Nightengale&&(c/=a.catTotals[d],isNaN(c)||Infinity===c||(a.maxRatio=Math.max(a.maxRatio,
c)))}});b.o.additive&&(a.catTotals.push(f),a instanceof BarGroup&&(b.min=Math.min(f,b.min),b.max=Math.max(f,b.max)))}else a.catTotals.push(0)},fn2:function(c,d,e){0>a.oExcludes.cat.indexOf(e)?(a.total+=c,a.catTotals.push(c),a instanceof BarGroup&&(b.min=Math.min(c,b.min),b.max=Math.max(c,b.max))):a.catTotals.push(0)}});0<=["pie","donut"].indexOf(b.o.type)&&(a.o.subtitle=b.formatNo(a.total,b.o.sigFigs)+" "+b.o.units,a.TOTAL||(a.TOTAL=a.total,b.maxTotal=Math.max(a.total,b.maxTotal),b.maxRatio=Math.max(a.maxRatio,
b.maxRatio)));return a}
function fnTitles(){var a,b,c;this instanceof RaphaGraph?(a=this,b=a.text.titleAttr,c=a.text.subTitleAttr,this.plotY+=this.o["title-padding-top"],this.plotH0-=this.o["title-padding-top"]):(a=this.o.rg,b=a.text.groupTitle,c=a.text.groupSubTitle);if(this.o.title){var d=(this.o.title.match(/\n/g)?this.o.title.match(/\n/g).length:0)+1,e=this.o.w/2,f;this instanceof RaphaGraph?(f=this.plotY+b["font-size"]*d/2,d=f+b["font-size"]*d/2+this.o["title-padding-bottom"]):(e+=this.o.dx,f=this.o.dy+b["font-size"]*
d/2,d=b["font-size"]*d+4);this.rTitle||(this.rTitle=a.o.paper.text(e,f,this.o.title).attr(b));this.plotY+=d;this.plotH0-=d}this.o.subtitle&&(d=(this.o.subtitle.match(/\n/g)?this.o.subtitle.match(/\n/g).length:0)+1,e=this.o.w/2,this instanceof RaphaGraph?(f=this.plotY+this.o["subtitle-padding-top"]+c["font-size"]*d/2,d=this.o["subtitle-padding-top"]+c["font-size"]*d+this.o["subtitle-padding-bottom"]):(e+=this.o.dx,f=this.plotY+c["font-size"]*d/2,d=c["font-size"]*d+4),this.rSubTitle||(this.rSubTitle=
a.o.paper.text(e,f,this.o.subtitle).attr(c)),this.plotY+=d,this.plotH0-=d);return this}function log10(a){return Math.log(a)/Math.LN10}
function getIntervals(a,b,c,d){var e=[2,2.5,5,10],f;a=Math.min(a,0);for(var h=b-a,g=10;2<=g;g--)if(c/g>d){f=g;break}if(f){d=Math.floor(log10(h))-1;for(var k;!k;){for(g=0;g<e.length;g++)if(Math.ceil(h/(e[g]*Math.pow(10,d)))<=f){k=e[g]*Math.pow(10,d);e=[];f=0>a?-1:1;f*=Math.ceil(Math.abs(a)/k)*k;a=Math.ceil(b/k)*k;a==b&&(a+=k);for(b=f;b<=a;b+=k)e.push(b);b={labels:e,range:e[e.length-1]-e[0],"value-interval":k,min:e[0],max:e[e.length-1]};b.scale=c/b.range;b["pixel-interval"]=k*b.scale;return b}d++}}return!1}
function fnBlank(){}function fnErase(){this.rData.remove()}
function fnIter(a){var b=this instanceof RaphaGraph?this:this.o.rg,c=!0;if(a.a[0]instanceof Array)for(var d=0;d<a.a.length&&(c=b.o.names[a.scope][d],c=a.fn1(a.a[d],d,c),!1!==c);d++);else if(a.a[0]instanceof Object)for(d=0;d<a.a.length&&(c=a.a[d].name||b.o.names[a.scope][d],c=a.a[d].value?a.fn2(a.a[d].value,d,c):a.fn1(a.a[d].data,d,c),!1!==c);d++);else if("number"==typeof a.a[0])for(d=0;d<a.a.length&&(c=b.o.names[a.scope]instanceof Array?b.o.names[a.scope][d]:void 0,c=a.fn2(a.a[d],d,c),!1!==c);d++);
}
function fnBox(a){a.boxAttr=$.extend({opacity:1,fill:"#FFFFFF","stroke-width":5,stroke:"#000",cursor:"pointer"},a.boxAttr);oAttr=$.extend({"font-size":14},a.textAttr);var b=document.createElement("div"),c=0,d=0,e=0;b.innerHTML=a.s;var f=this.paper.set(),h=b.childNodes;this.paper.setStart();for(var g=0;g<h.length;g++){var k=$.extend({},oAttr);"I"==h[g].tagName?k["font-style"]="italic":"B"==h[g].tagName&&(k["font-weight"]="bold");for(var q=h[g].textContent.split("\n"),n=0;n<q.length;n++){var b=this.paper.text(0,0,
q[n]).attr(k),r=b.getBBox();0<n&&(e=0);if(0==g&&0==n||0<n)d+=k["font-size"]+3;b.attr({x:e+r.width/2,y:d-k["font-size"]/2});e+=r.width;c=Math.max(e,c)}}b=this.getBBox();h=1;a.x||(a.x=b.x+b.width/2);a.y||(a.y=b.y+b.height/2);c+26>this.paper.width&&(h=this.paper.width/(c+26));d+20>this.paper.height&&(h=Math.min(h,this.paper.height/(b.height+20)));d*=h;c*=h;b.x-26>c?a.x=b.x-c-13:this.paper.width-b.x2-26>e?a.x=b.x2+13:b.y-26<d?a.y=b.y-13:this.paper.height-b.y2-26>d&&(a.y=b.y2+13);a.x+c+26>this.paper.width&&
(a.x-=c+26+a.x-this.paper.width);a.y+(d+26)>this.paper.height&&(a.y-=d+26+a.y-this.paper.height);b=this.paper.setFinish();c=this.paper.rect(a.x-10,a.y-9,c+20,d+20,4).attr(a.boxAttr);b.transform("t"+a.x+","+a.y+"s"+h).toFront();f.push(c,b);f.container=c;c.rPiece=this;return f}
function fnHoverIn(){var a=this,b=a.paper.rg;if(!a.mouseIn){a.mouseIn=!0;b.rBoxes.items.forEach(function(a){a.fnOut()});a.attr({stroke:"white","stroke-width":"2"});a.toFront();var c=b.o.fnS.call(a);a.rBox=fnBox.call(a,{textAttr:b.o.textAttr,boxAttr:{stroke:a.data("color"),"stroke-width":2},s:c});a.rBox.click=function(){this.paper.rg.o.fnClick.call(this.rPiece)};a.fnOut=function(){if(a.mouseIn){a.mouseIn=!1;a.attr({stroke:"black","stroke-width":"1"});a.toBack();for(var c=a.data("aBacks")||[],e=0;e<
c.length;e++)a.paper.getById(c[e]).toBack();b.rPlot.toBack();a.rBox.remove();b.rBoxes.exclude(a)}};a.rBox.container.hover(fnBlank,function(b){setTimeout(function(){var b=currentMousePos.offset(a.paper.rg.o.container);a.isPointInside(b.x,b.y)||a.rBox.container.isPointInside(b.x,b.y)||a.fnOut()},200)});b.rBoxes.push(a)}}
function fnHoverOut(a){var b=this;this.mouseIn&&setTimeout(function(){var a=currentMousePos.offset(b.paper.rg.o.container);b.isPointInside(a.x,a.y)||b.rBox.container.isPointInside(a.x,a.y)||b.fnOut()},200)}function RaphaGraphError(a){this.name="RaphaGraph Error";this.message=a||""}RaphaGraphError.prototype=Error.prototype;function tooFar(){throw new RaphaGraphError("Your data has too much depth. Either set groups to true, add frames, or decrease data depth.");}
function fnLegend(a){function b(b,u){var t=m.rect(e,f,k,q,3),s=m.text(e,f,b).attr(c.text.legendAttr),y=s.getBBox().width,v=n+q+g+y;t.attr({color:u,"stroke-width":0});l+v>=d&&(w.push(p),p=m.set(),f+=c.text.legendAttr["font-size"]/2+8,l=0,h++);var A=-v/2,C=e+l/2+n-v/2,y=C+q/2+n+y/2,B=m.set();s.attr({x:y,y:f,cursor:"pointer"});t.attr({x:C,y:f-k/2,fill:u,cursor:"pointer"});s.id=Raphael.createUUID();t.id=Raphael.createUUID();s.data("rMarker",t.id);t.data("on",!0);t.data("color",u);t.data("text",b);t.click(a.fnClick);
s.click(function(){a.fnClick.call(m.getById(this.data("rMarker")))});B.push(s);B.push(t);p.transform("...t"+A+",0");p.push(B);l+=v-n;r=Math.max(l,r)}var c=this,d=0.8*c.o.w,e=c.o.w/2,f=0,h=1,g=5,k=12,q=12,n=10,r=0,l=0,m=c.o.paper||c.o.paper,p=m.set(),w=m.set(),h=0;a.fnClick||(a.fnClick=function(){c.rBoxes.items.forEach(function(a){a.fnOut()});var b=this.data("text");this.data("on")?(this.data("on",!1),this.attr({fill:"#BDBDBD"}),0>c.oExcludes[a.scope].indexOf(b)&&c.oExcludes[a.scope].push(b)):(this.data("on",
!0),this.attr({fill:this.data("color")}),c.oExcludes[a.scope].splice(c.oExcludes[a.scope].indexOf(b),1));c.filter()});c.fnIter({a:a.aData,scope:a.scope,fn2:function(d,e,f,g,h){g||(g=c.o.oColors[f]||c.o.aColors[e]);c.o.gradient===a.scope&&(g=fnLighten(g,1-Math.pow(0.8,e)));b(f,g)},fn1:function(d,e,f){d=c.o.oColors[f]||c.o.aColors[e];c.o.gradient===a.scope&&(d=fnLighten(d,1-Math.pow(0.8,e)));b(f,d)}});w.push(p);var t=c.text.legendAttr["font-size"],s=m.rect(e-(r+40)/2-g,-t/2-4,r+40+g,(h+1)*(t+2)+8,5);
s.attr(c.o.legendBoxAttr);w.push(s);c.legendHeight=s.getBBox().height;w.transform("...t0 "+(c.o.h-c.legendHeight+t/2+4)).show();c.legendHeight+=20;c.plotH0-=c.legendHeight}
function fnAnimate(a){var b;b=this instanceof RaphaGraph?this:this.o.rg;setTimeout(function(){for(var c=Raphael.animation(a.aAnimation[0].attr,b.o.animationLength,a.easing||"elastic"),d=a.aAnimation[0].elem,e=1;e<a.aAnimation.length;e++)a.aAnimation[e].elem.animateWith(c,d,a.aAnimation[e].attr,b.o.animationLength,a.easing||"elastic");d.animate(c)},a.delay)}
window.RaphaGraph=function(a){var b=this;a.type||(a.type="bar");b.depth=0;a.frames&&(a.aData=a.frames.aData[0]);for(var c=a.aData;c instanceof Array;)b.depth++,c=c[0].data||c[0];b.o={legend:!0,frames:!1,frameInterval:4E3,animate:!0,animationLength:1E3,gradient:"var",opacity:!1,"color-scope":"cat",oColors:!1,aColors:"rgb(255,189,35) rgb(61,147,33) rgb(0,128,166) rgb(120,64,176) rgb(236,48,48) rgb(6,28,124)".split(" "),chartBackground:!1,plotBackground:!1,fnHoverIn:fnHoverIn,fnHoverOut:fnHoverOut,fnClick:fnBlank,
fnS:function(){var a;1==this.paper.rg.depth&&b.o.groups?a="<b>"+this.data("group")+"</b>\n":(a=this.data("cat")?"<b>"+this.data("cat")+"- ":"<b>",a+=this.data("var")?this.data("var")+":</b>\n":"</b>\n");a+=b.formatNo(this.data("val"));return a+=" "+this.paper.rg.o.units},type:"bar",additive:!1,groups:!0,legend:!0,dx:0,dy:0,title:!1,subtitle:!1,units:"","title-padding-top":5,"title-padding-bottom":7,"subtitle-padding-top":3,"subtitle-padding-bottom":10,"legend-padding-x":3,"legend-padding-y":3,"legend-padding-top":3,
"legend-padding-bottom":3,textAttr:{"font-family":'"Trebuchet MS", Helvetica, sans-serif',"font-size":14},titleAttr:{"font-size":16},subTitleAttr:{},legendAttr:{"font-size":16,cursor:"pointer"},legendBoxAttr:{"stroke-width":1,color:"black"}};b.o.w=document.getElementById(a.container).offsetWidth;0<=["pie","donut"].indexOf(a.type)?(1==b.depth&&(b.o["color-scope"]="group"),$.extend(!0,b.o,{dy:0,dx:0,dataAttr:{},crustAttr:{},wedgeAttr:{},groupTitle:{},groupSubTitle:{},variables:"radial",closed:!0,categories:"wedges"},
a),b.crustAttr=$.extend(!0,{},b.o.dataAttr,b.o.crustAttr),b.wedgeAttr=$.extend(!0,{},b.o.dataAttr,b.o.wedgeAttr)):0<=["bar","tabs"].indexOf(a.type)&&(1==b.depth&&b.o.groups&&(b.o["color-scope"]="group"),c={"x-label-padding-left":3,"x-label-padding-right":3,"x-label-padding-top":3,"x-label-padding-bottom":3,"y-label-padding-left":5,"y-label-padding-right":5,"x-axis-label-rotate":0,"x-axis-padding":15,"y-axis-padding":10,"x-axis-label-scope":"group",gridAttr:{"stroke-dasharray":". ","stroke-width":1,
stroke:"black"},originAttr:{"stroke-width":2,stroke:"black"},xLabels:{"font-size":14},yLabels:{"font-size":14},xLabelTitle:{"font-size":16},yLabelTitle:{"font-size":16},groupPadding:10,catPadding:5},a.minMax&&(c.fnS=function(){var a=this.data("cat")?"<b>"+this.data("cat")+" ":"<b>",a=a+(this.data("var")?this.data("var")+":</b>\n":"</b>\n"),a=a+("low: "+b.formatNo(this.data("lo"))+" "+b.o.units+"\n");return a+="high: "+b.formatNo(this.data("hi"))+" "+b.o.units}),$.extend(!0,b.o,c,a));b.o.groups||b.o.names.group||
(b.o.names.group=[""]);b.o.h||(b.o.h=0.75*b.o.w);document.getElementById(b.o.container).innerHTML="";b.oG="bar"==a.type?a.minMax?Tabs:BarGroup:"concentric"==b.o.variables?Nightengale:Donut;b.text={};"titleAttr subTitleAttr legendAttr xLabelTitle yLabelTitle xLabels yLabels groupTitle groupSubTitle".split(" ").forEach(function(a){b.text[a]=$.extend({},b.o.textAttr,b.o[a])});b.o.paper=a.paper?a.paper:Raphael(b.o.container,b.o.w,b.o.h);b.o.paper.rg=b;b.rBoxes=b.o.paper.set();b.oExcludes={group:[],cat:[],
"var":[]};b.rData=b.o.paper.set();b.total().chart().plotArea();b.o.frames?b.setFrames():b.plot();return b};
RaphaGraph.prototype.total=function(){var a=this;0<=["pie"].indexOf(a.o.type)?(a.maxTotal=0,a.maxRatio=1):0<=["bar"].indexOf(a.o.type)&&(a.min=0,a.max=0);if(a.o.groups){var b=function(b,c,d){b=new a.oG({title:d,rg:a,aData:b,index:c});b.fnTotal();return b},c=function(c){var d=[];a.fnIter({scope:"group",a:c,fn1:function(a,c,e){d.push(b(a,c,e))},fn2:function(a,c,e){d.push(b([a],c,e))}});return d};if(a.o.frames){a.o.frames.a=[];for(var d=0;d<a.o.frames.aData.length;d++)a.o.frames.a.push(c(a.o.frames.aData[d]));
a.a=a.o.frames.a[0]}else a.a=c(a.o.aData)}else if(a.o.frames){a.o.frames.a=[];for(d=0;d<a.o.frames.aData.length;d++)c={rg:a,title:a.o.names.group[0]||"",aData:a.o.frames.aData[d],index:0},c=new a.oG(c),a.o.frames.a.push([c]),c.fnTotal();a.a=a.o.frames.a[0]}else c={rg:a,title:a.o.names.group[0]||"",aData:a.o.aData,index:0},c=new a.oG(c),a.a=[c],c.fnTotal();return a};
RaphaGraph.prototype.chart=function(){this.legendHeight=0;this.plotH0=this.o.h;this.plotY=0;if(this.o.legend){var a=this.o.aData;this.o.groups||(a=[a]);this.fnLegend({scope:this.o["color-scope"],aData:"group"==this.o["color-scope"]?a:"cat"==this.o["color-scope"]?a[0].data||a[0]:(a[0].data||a[0])[0].data||(a[0].data||a[0])[0]})}this.titles();return this};
RaphaGraph.prototype.plotArea=function(){var a=this,b=a.o.paper,c=a.plotH0,d=a.plotY;if(0<=["bar","tabs"].indexOf(a.o.type)){b.setStart();var e=[],f,h=0;"cat"==a.o["x-axis-label-scope"]?f="cat":"group"==a.o["x-axis-label-scope"]&&(f="group");for(var g=0;g<a.o.names[f].length;g++){var k=a.o.names[f][g];if(0>a.oExcludes[f].indexOf(k)){var q=b.text(10,10,k).transform("r-"+a.o["x-axis-label-rotate"]);q.attr(a.text.xLabels);h=Math.max(q.getBBox().height,h);e.push(q)}}c-=h+a.o["x-label-padding-top"];a.axLabels=
e;f=getIntervals(a.min,a.max,c,a.text.yLabelTitle["font-size"]+10);for(var k=0,n=[],g=a.o.yLabelWidth=0;g<f.labels.length;g++)q=b.text(a.o.w/2,a.o.h/2,a.formatNo(f.labels[g])).attr(a.text.yLabels),a.o.yLabelWidth=Math.max(q.getBBox().width,a.o.yLabelWidth),n.push(q);var q=a.o["y-label-padding-left"]+a.o["y-label-padding-right"]+a.text.xLabelTitle["font-size"]+a.o["y-axis-padding"]+a.o.yLabelWidth,r=a.o.w-q-20;b.text(a.o.w/2,d+c+a.o["x-axis-padding"]+a.text.xLabelTitle["font-size"],a.o["x-label"]||
"").attr(a.text.xLabelTitle);for(g=0;g<n.length;g++){var l=n[g].show(),k=d+c-g*f["pixel-interval"],m=b.path("M"+q+" "+k+"L"+(q+r)+" "+k+"Z");l.attr({x:q-l.getBBox().width/2-2,y:k});0==f.labels[g]?m.attr(a.o.originAttr):m.attr(a.o.gridAttr)}g=a.o["y-label"]||a.o.units;n=(g.match(/\n/g)?g.match(/\n/g).length:0)+1;b.text(a.o["y-label-padding-left"]+a.text.yLabelTitle["font-size"]*n/2,d+c/2,g).transform("r-90").attr(a.text.yLabelTitle);a.groupW=r/(a.a.length-a.oExcludes.group.length);var p=a.groupW,w=
p-2*a.o.groupPadding,t=d+c+a.o["x-label-padding-top"]+h/2,s=q+p/2,x=0;a.o.groups?a.fnIter({a:a.o.aData,scope:"group",fn1:function(b,c,d){if(0>a.oExcludes.group.indexOf(d)){var f=s+p*x;a.o["x-axis-rotate"]&&(f-=e[x].getBBox().width/2);if("group"==a.o["x-axis-label-scope"])e[x].attr({x:f,y:t}).show();else{var g=b.length-a.oExcludes.cat.length,h=(w-a.o.catPadding)/g,k=0;a.fnIter({a:b,scope:"group",fn1:function(b,c,d){0>a.oExcludes.cat.indexOf(d)&&(e[x].attr({x:f+(2*k+1-g)/2*h,y:t}).show(),k++)},fn2:function(b,
c,d,p,q){0>a.oExcludes.cat.indexOf(sCat)&&(e[x].attr({x:f+(2*k+1-g)/2*h,y:t}).show(),k++)}})}x++}},fn2:function(b,c,d,f,g){0>a.oExcludes.group.indexOf(d)&&(b=s+p*x,a.o["x-axis-rotate"]&&(b-=e[x].getBBox().width/2),"group"==a.o["x-axis-label-scope"]&&e[x].attr({x:b,y:t}).show(),x++)}}):(a.o["x-axis-rotate"]&&(s-=e[0].getBBox().width/2),"group"==a.o["x-axis-label-scope"]&&e[0].attr({x:s,y:t}).show());a.groupInnerW=w;a.plotX=q;a.plotY=d;a.plotH=c;a.plotW=r;a.oGrid=f;a.y0=k;a.rPlot=b.setFinish()}else{a.rPlot=
a.o.paper.set();a.R=0;a.scale=Infinity;if(a.o.groups){for(var g=a.o.aData.length,u=Math.sqrt(a.plotH0*a.o.w/g),z=Math.floor(a.o.w/u),b=Math.floor(a.plotH0/u),c=b*z;c<g;)u--,z=Math.floor(a.o.w/u),b=Math.floor(a.plotH0/u),c=b*z;var D=(a.plotH0-b*u)/(b+1),y=0,v=0,A;A=v+1==b?(a.o.w-u*(g-z*v))/(g-z*v+1):(a.o.w-u*z)/(z+1);b=function(b){b.o.dx=A*(y+1)+u*y;b.o.dy=a.plotY+D*(v+1)+u*v;b.o.w=u;b.o.h=u;b.plotArea();a.scale=Math.min(b.scale,a.scale);y++;y==z&&(y=0,v++)};if(a.o.frames)for(g=0;g<a.o.frames.a.length;g++)for(c=
v=y=0;c<a.o.frames.a[g].length;c++)b(a.o.frames.a[g][c]);else for(g=0;g<a.a.length;g++)b(a.a[g])}else if(b=function(b){b.o.w=a.o.w;b.o.h=a.plotH0;b.o.dy=a.plotY;b.plotArea();a.scale=Math.min(b.scale,a.scale);a.R=Math.max(b.R,a.R)},a.o.frames)for(g=0;g<a.o.frames.a.length;g++)b(a.o.frames.a[g][0]);else b(a.a[0]);a.R=Math.sqrt(a.scale*a.maxTotal/Math.PI);a.rPlot.attr({r:a.R}).show()}return a};
RaphaGraph.prototype.plot=function(){var a=this;if(0<=["pie","donut"].indexOf(a.o.type))a.a.forEach(function(b,c){b.R=a.R;b.scale=a.scale;b.plot();a.o.animate&&b.animate({delay:c*a.o.animationLength,aAnimation:b.aAnimations})});else if(0<=["bar","tabs"].indexOf(a.o.type)){var b=0;a.aAnimations=[];a.a.forEach(function(c,e){0>a.oExcludes.group.indexOf(c.o.title)&&(c.groupI=b,c.plot(),b++)});if(a.o.animate)for(var c=0;c<a.aAnimations.length;c++)a.animate({aAnimation:a.aAnimations[c],delay:c*a.o.animationLength,
easing:"<>"})}return a};
RaphaGraph.prototype.setFrames=function(){function a(){e&&(b.rBoxes.items.forEach(function(a){a.fnOut()}),b.o.frames.fnPre(d),b.hide(),b.a=b.o.frames.a[d],b.show(),b.o.frames.fnPost(d),d==b.o.frames.aData.length-1?d=0:d++,e=!0)}var b=this;b.o.animate=!1;for(var c=0;c<b.o.frames.a.length;c++)b.a=b.o.frames.a[c],b.plot().hide();b.a=b.o.frames.a[0];b.show();b.o.frames.fnPre=b.o.frames.fnPre?b.o.frames.fnPre:fnBlank;b.o.frames.fnPost=b.o.frames.fnPost?b.o.frames.fnPost:fnBlank;var d=1,e=!0,f=setInterval(a,
b.o.frameInterval);b.pause=function(c){0<=parseInt(c)&&(e=!0,d=c,a());e=!1;return b};b.resume=function(){e=!0;return b};b.stop=function(){clearInterval(f);return b};return b};RaphaGraph.prototype.erase=function(){this.rData.remove()};RaphaGraph.prototype.titles=fnTitles;RaphaGraph.prototype.fnIter=fnIter;RaphaGraph.prototype.fnLegend=fnLegend;RaphaGraph.prototype.animate=fnAnimate;RaphaGraph.prototype.show=function(){for(var a=0;a<this.a.length;a++)this.a[a].show();return this};
RaphaGraph.prototype.hide=function(){for(var a=0;a<this.a.length;a++)this.a[a].hide()};
RaphaGraph.prototype.filter=function(){var a=this;a.o.animate=!1;a.rPlot.remove();a.plotArea();if(a.o.frames){a.pause().erase();for(var b=0;b<a.o.frames.a.length;b++){var c=0;a.o.frames.a[b].forEach(function(b){b.oExcludes=a.oExcludes;0>a.oExcludes.group.indexOf(b.o.title)&&(b.groupI=c,c++,b.fnTotal().plot().hide())})}a.show().resume()}else a.erase(),c=0,a.a.forEach(function(b){b.oExcludes=a.oExcludes;0>a.oExcludes.group.indexOf(b.o.title)&&(b.groupI=c,c++,b.fnTotal().plot())});return a};
RaphaGraph.prototype.getColor=function(a){var b={};b.fill=this.o.oColors?"group"==this.o["color-scope"]?this.o.oColors[a.sGroup]:"cat"==this.o["color-scope"]?this.o.oColors[a.sCat]:this.o.oColors[a.sVar]:this.o.aColors[a[this.o["color-scope"]]||0];a[this.o.gradient]&&(b.fill=fnLighten(b.fill,1-Math.pow(0.8,a[this.o.gradient])));a[this.o.opacity]&&(b["fill-opacity"]=Math.pow(0.8,a[this.o.opacity]));return b};
RaphaGraph.prototype.fnSigFigs=function(a,b){var c=0>a?-1:1;a=Math.abs(a);var d=Math.pow(10,b-Math.floor(Math.log(a)/Math.LN10)-1);return 1==d?Math.round(a)*c:1>d?Math.round(a*d)*Math.round(1/d)*c:Math.round(a*d)/d*c};
RaphaGraph.prototype.formatNo=function(a){if(0==a)return"0";this.o.sigFigs&&(a=this.fnSigFigs(a,this.o.sigFigs));var b=a.toString().split(".");a=parseInt(b[0]||0);b=parseInt(b[1]||0);if(a)for(;/(\d+)(\d{3})/.test(a.toString());)a=a.toString().replace(/(\d+)(\d{3})/,"$1,$2");else a="0";if(b){for(a+=".";/(\d+)(\d{3})/.test(b.toString());)b=b.toString().replace(/(\d+)(\d{3})/,"$1 $2");a+=b}return a};
var Nightengale=function(a){this.o=a;this.o.dx=0;this.o.dy=0;this.maxRatio=1;this.oExcludes={cat:[],"var":[]};this.rBoxes=this.o.rg.o.paper.set();return this};Nightengale.prototype.fnTotal=fnTotal;
Nightengale.prototype.plotArea=function(){this.plotH0=this.o.h||rg.plotH0;this.plotY=this.o.dy;this.titles();this.rTitle&&this.rTitle.hide();this.rSubTitle&&this.rSubTitle.hide();this.maxR=this.plotH0/2;this.scale||(this.scale=Math.pow(this.maxR,2)*Math.PI/(this.TOTAL*this.maxRatio));this.R=Math.sqrt(this.scale*this.TOTAL/Math.PI);this.o.cx=this.o.dx+this.o.w/2;this.o.cy=this.plotY+this.plotH0/2;this.rPlot=this.o.rg.o.paper.circle(this.o.cx,this.o.cy,this.R).attr({"stroke-dasharray":"- "}).hide();
this.o.rg.rPlot.push(this.rPlot);return this};
Nightengale.prototype.plot=function(){var a=this,b=a.o.rg,c=0;a.aAnimations=[];a.rData=b.o.paper.set();a.rTitle&&a.rTitle.show();a.rSubTitle.attr({text:b.formatNo(a.total)+" "+b.o.units});a.rSubTitle.show();a.fnIter({a:a.o.aData,scope:"cat",fn1:function(d,e,f){if(0>a.oExcludes.cat.indexOf(f)){var h=a.catTotals[e]/a.total*360,g=0,k=[];a.fnIter({a:d,scope:"var",fn1:tooFar,fn2:function(d,n,r){if(0>a.oExcludes["var"].indexOf(r)){var l=b.getColor({sCat:f,sVar:r,group:a.o.index,cat:e,"var":n,scope:"var"}),
m=Math.sqrt(a.scale*d*360/h/Math.PI+Math.pow(g,2));b.o.additive?(n=0==n?fnWedge(a.o.cx,a.o.cy,m,c,c+h):fnCrust(a.o.cx,a.o.cy,g,m,c,c+h),g+=m-g):(m=Math.sqrt(a.scale*d*360/h/Math.PI),n=fnWedge(a.o.cx,a.o.cy,m,c,c+h));a.fnPiece({params:l,aBacks:k,sPath:n,data:{val:d,cat:f,"var":r}})}}});c+=h}},fn2:function(d,e,f){if(0>a.oExcludes.cat.indexOf(f)){var h=b.getColor({sCat:f,cat:e,sGroup:a.o.title,group:a.o.index,scope:"cat"});e=a.catTotals[e]/a.total*360;var g=Math.sqrt(a.total*a.scale/Math.PI),g=fnWedge(a.o.cx,
a.o.cy,g,c,c+e);a.fnPiece({sPath:g,params:h,aBacks:[],data:{val:d,cat:f}});c+=e}}});b.rData.push(a.rData);return a};Nightengale.prototype.hide=function(){this.rTitle&&this.rTitle.hide();this.rSubTitle&&this.rSubTitle.hide();this.rData.hide();this.rPlot.hide();this.rBoxes.clear();return this};Nightengale.prototype.show=function(){this.rTitle&&this.rTitle.show();this.rSubTitle&&this.rSubTitle.show();this.rData.show();this.rPlot.show();return this};
Nightengale.prototype.erase=function(){this.rTitle&&this.rTitle.remove();this.rSubTItle&&this.rSubtitle.remove();this.rData.remove();this.rPlot.remove();this.rBoxes.remove();return this};Nightengale.prototype.titles=fnTitles;Nightengale.prototype.fnIter=fnIter;Nightengale.prototype.animate=fnAnimate;Nightengale.prototype.fnPiece=fnPiece;
var Donut=function(a){a.rg.o.additive||(a.rg.o.additive=!0);this.o=a;this.catTotals=[];this.total=0;this.o.dx=0;this.o.dy=0;this.oExcludes={cat:[],"var":[]};this.rBoxes=this.o.rg.o.paper.set();this.maxRatio=1;"rings"==a.rg.o.categories&&(a.rg.o.closed=!1);return this};
Donut.prototype.plotArea=function(){var a=this.o.rg;this.plotH0=this.o.h||a.plotH0;this.plotY=this.o.dy;this.titles();this.rTitle&&this.rTitle.hide();this.rSubTitle&&this.rSubTitle.hide();this.maxR=this.plotH0/2;this.scale||(this.scale=Math.pow(this.maxR,2)*Math.PI/this.TOTAL);this.R=Math.sqrt(this.scale*this.TOTAL/Math.PI);this.o.cx=this.o.dx+this.o.w/2;this.o.cy=this.plotY+this.plotH0/2;this.rPlot=this.o.rg.o.paper.circle(this.o.cx,this.o.cy,this.R).attr({"stroke-dasharray":"- "}).hide();a.rPlot.push(this.rPlot);
return this};
Donut.prototype.plot=function(){var a=this,b=a.o.rg,c=0;a.rTitle&&a.rTitle.show();a.rSubTitle&&(a.rSubTitle.attr({text:b.formatNo(a.total)+" "+b.o.units}),a.rSubTitle.show());a.r=[];var d;"wedges"==b.o.categories?d=2:(d=a.o.aData[0]instanceof Array?a.o.aData.length:1,d-=a.oExcludes.cat.length);for(var e=Math.sqrt(a.scale*a.total/Math.PI),f=e/d/2,h=0;h<=d;h++)a.r.push(e/2+f*h);a.aAnimations=[];a.rData=b.o.paper.set();var g=0;a.fnIter({a:a.o.aData,scope:"cat",fn1:function(d,e,h){if(0>a.oExcludes.cat.indexOf(h)){var r=[],
l=a.catTotals[e]/a.total*360,m=b.getColor({sCat:h,group:a.o.index,cat:e,"var":0,scope:"var"});if("wedges"==b.o.categories){var p;p=1==d.length?a.r[2]:a.r[1];l=b.o.closed?fnWedge(a.o.cx,a.o.cy,p,c,c+l):fnCrust(a.o.cx,a.o.cy,a.r[0],p,c,c+l);a.fnPiece({sPath0:["M",a.o.cx,a.o.cy],sPath:l,params:m,data:{val:a.catTotals[e],cat:h},aBacks:r});1==d.length&&(c+=f)}else c=0;a.fnIter({a:d,scope:"var",fn1:tooFar,fn2:function(f,p,s){if(0>a.oExcludes["var"].indexOf(s)){var l,m;"wedges"!==b.o.categories?(m=b.getColor({sCat:h,
sVar:s,group:a.o.index,cat:e,"var":p,scope:"var"}),p=f/a.catTotals[e]*360,l=b.o.closed&&0==g?fnWedge(a.o.cx,a.o.cy,a.r[g+1],c,c+p):fnCrust(a.o.cx,a.o.cy,a.r[g],a.r[g+1],c,c+p),c+=p):1<d.length&&(m=b.getColor({sCat:h,sVar:s,group:a.o.index,cat:e,"var":p+1,scope:"var"}),p=f/a.total*360,l=fnCrust(a.o.cx,a.o.cy,a.r[1],a.r[2],c,c+p),c+=p);l&&a.fnPiece({sPath0:["M",a.o.cx,a.o.cy],sPath:l,params:m,data:{val:f,"var":s,cat:h,group:b.o.names.group[0]||a.o.title},aBacks:r})}}});g++}},fn2:function(d,e,f){if(0>
a.oExcludes.cat.indexOf(f)){e=b.getColor({sCat:f,cat:e,sGroup:a.o.title,group:a.o.index,scope:"cat"});var h=d/a.total*360,l;l="wedges"==b.o.categories?d==a.total?b.o.closed?fnWedge(a.o.cx,a.o.cy,a.r[2],0,360):fnDonut(a.o.cx,a.o.cy,a.r[0],a.r[2]):b.o.closed?fnWedge(a.o.cx,a.o.cy,a.r[2],c,c+h):fnCrust(a.o.cx,a.o.cy,a.r[0],a.r[2],c,c+h):fnDonut(a.o.cx,a.o.cy,a.r[g],a.r[g+1]);a.fnPiece({sPath:l,params:e,data:{val:d,cat:f,group:b.o.names.group[0]||a.o.title},aBacks:[]});c+=h;g++}}});b.rData.push(a.rData);
return a};Donut.prototype.show=function(){this.rTitle&&this.rTitle.show();this.rSubTitle&&this.rSubTitle.show();this.rData.show();this.rPlot.show();return this};Donut.prototype.hide=function(){this.rTitle&&this.rTitle.hide();this.rSubTitle&&this.rSubTitle.hide();this.rData.hide();this.rPlot.hide();this.rBoxes.clear();return this};Donut.prototype.fnTotal=fnTotal;Donut.prototype.titles=fnTitles;Donut.prototype.animate=fnAnimate;Donut.prototype.fnIter=fnIter;Donut.prototype.fnPiece=fnPiece;
var BarGroup=function(a){this.o=a;this.oExcludes={cat:[],"var":[]};this.rBoxes=this.o.rg.o.paper.set();return this};BarGroup.prototype.fnTotal=fnTotal;
BarGroup.prototype.plot=function(){function a(a){var d=b.o.title||c.o.names.group[b.o.index],e=c.getColor({sCat:a.data.cat,sVar:a.data["var"],sGroup:d,group:b.o.index,cat:a.j,"var":a.k,scope:a.scope}),f=a.val*h,k,l=c.o.additive?0:a.k||0;c.o.additive?(k=Rect(a.x-a.varW/2,a.y-f,a.varW,f),f="M"+a.x+" "+(a.y-f)+"L"+a.x+" "+a.y+"L"+(a.x+2)+" "+a.y+"L"+(a.x+2)+" "+(a.y-f)+"L"+a.x+" "+(a.y-f)+"Z"):(k=Doll(a.x,g,a.varW,f),f="M"+a.x+" "+g+"Z");b.fnPiece({sPath:k,sPath0:f,params:e,aBacks:a.aBacks,data:{val:a.val,
cat:a.data.cat,"var":a.data["var"],group:d},aAnimations:c.aAnimations[l]})}var b=this,c=this.o.rg,d=c.groupInnerW,e=c.plotX,f=c.groupW,h=c.oGrid.scale,g=c.plotY+c.plotH,k=b.groupI;b.rData=c.o.paper.set();if(b.o.aData instanceof Array){var q=e+f/2+f*k,n=b.o.aData.length-c.oExcludes.cat.length,r=(d-c.o.catPadding)/n,l=r-2*c.o.catPadding,m=0;c.fnIter({a:b.o.aData,scope:"cat",fn1:function(d,e,f){if(0>c.oExcludes.cat.indexOf(f)){var s=q+(2*m+1-n)/2*r,x=g,u=[];c.fnIter({a:d,scope:"var",fn2:function(d,g,
m){0==k&&0==e&&(c.o.additive&&0!=g||c.aAnimations.push([]));0>c.oExcludes["var"].indexOf(m)&&(a({x:s,y:x,val:d,j:e,k:g,name:m,varW:c.o.additive?l:l*Math.pow(0.75,g),scope:"var",aBacks:u,data:{group:b.o.title,cat:f,"var":m,val:d}}),c.o.additive&&(x-=d*h))},fn1:tooFar});m++}},fn2:function(d,e,f){0==k&&0==e&&c.aAnimations.push([]);0>c.oExcludes.cat.indexOf(f)&&(a({x:q+(2*m+1-n)/2*r,y:g,val:d,j:e,name:name,varW:l,scope:"cat",aBacks:[],data:{group:b.o.title,cat:f,val:d}}),m++)}})}else 0==k&&c.aAnimations.push([]),
q=e+f/2+f*k,a({x:q,y:g,val:b.o.aData,name:name,varW:d,scope:"group",aBacks:[],data:{group:b.o.title,val:val}});c.rData.push(b.rData);return b};BarGroup.prototype.fnIter=fnIter;BarGroup.prototype.hide=function(){this.rData.hide();this.rBoxes.clear()};BarGroup.prototype.show=function(){this.rData.show()};BarGroup.prototype.fnPiece=fnPiece;
var Tabs=function(a){if(a.rg.o.additive)throw a=new RaphaGraphError('minMax bar graphs cannot be stacked. Set "additive" to false.'),a;if(a.rg.o.animate)throw a=new RaphaGraphError('minMax bar graphs cannot be animated. Set "animate" to false.'),a;this.o=a;this.oExcludes={cat:[],"var":[]};this.rBoxes=this.o.rg.o.paper.set();return this};
Tabs.prototype.fnTotal=function(){var a=this,b=a.o.rg;a.total=0;a.fnIter({a:a.o.aData,scope:"cat",fn1:function(c,d,e){0>a.oExcludes.cat.indexOf(e)&&("number"==typeof c[0]?(c=c[1],b.min=Math.min(c,b.min),b.max=Math.max(c,b.max),a.total+=c):a.fnIter({a:c,scope:"var",fn1:function(c,d,g){0>a.oExcludes.cat.indexOf(e)&&(c=c[1],0==d&&(a.total+=c),b.min=Math.min(c,b.min),b.max=Math.max(c,b.max))}}))},fn2:tooFar});return a};
Tabs.prototype.plot=function(){var a=this,b=this.o.rg,c=b.groupInnerW,d=b.groupW,e=b.oGrid.scale,f=b.plotY+b.plotH,h=a.groupI,g=a.o.title||b.o.names.group[a.o.index],k=b.plotX+d/2+d*h,q=a.o.aData.length-b.oExcludes.cat.length,n=(c-b.o.catPadding)/q,r=n-2*b.o.catPadding,l=0;a.rData=b.o.paper.set();if(a.o.aData[0]instanceof Array)b.fnIter({a:a.o.aData,scope:"cat",fn1:function(c,d,m){if(0>b.oExcludes.cat.indexOf(m)){var p=k+(2*l+1-q)/2*n,z=[];if("number"==typeof c[0]){var w=c[0];c=c[1];0==h&&0==d&&b.aAnimations.push([]);
var y=b.getColor({sCat:m,sGroup:g,group:a.o.index,cat:d,scope:"cat"}),v={params:y,aBacks:[],data:{lo:w,hi:c,cat:m,group:g},aAnimations:b.aAnimations[0]};w!=c?v.rPiece=gradStrip({paper:b.o.paper,x:p,y:f,w:r,h1:w*e,h2:c*e,color:y.fill,aBacks:z}):(v.sPath=Doll(p,f,r,w*e),v.aBacks=z);a.fnPiece(v)}else varI=0,b.fnIter({a:c,scope:"var",fn1:function(c,k,l){if("number"==typeof c[0]){if(0>a.oExcludes["var"].indexOf(l)){0==h&&0==d&&b.aAnimations.push([]);var n=c[0];c=c[1];var q=b.getColor({sVar:l,sCat:m,sGroup:g,
group:a.o.index,cat:d,"var":k,scope:"cat"});l={params:q,aBacks:[],data:{lo:n,hi:c,"var":l,cat:m,group:g},aAnimations:b.aAnimations[varI]};n!=c?l.rPiece=gradStrip({paper:b.o.paper,x:p,y:f,w:r*Math.pow(0.75,k),h1:n*e,h2:c*e,color:q.fill,aBacks:z}):(l.sPath=Doll(p,f,r*Math.pow(0.75,k),n*e),l.aBacks=z);a.fnPiece(l)}varI++}else tooFar()}});l++}}});else if(0>b.oExcludes.group.indexOf(g)){0==h&&b.aAnimations.push([]);var d=a.o.aData[0],m=a.o.aData[1],p=b.getColor({sGroup:g,group:a.o.index,scope:"group"}),
w={params:p,data:{lo:d,hi:m,group:g},aAnimations:b.aAnimations[0]};d!=m?w.rPiece=gradStrip({paper:b.o.paper,x:k,y:f,w:c,h1:d*e,h2:m*e,color:p.fill,aBacks:[]}):(w.sPath=Doll(k,f,c,d*e),w.aBacks=[]);a.fnPiece(w)}b.rData.push(a.rData);return a};Tabs.prototype.fnIter=fnIter;Tabs.prototype.hide=function(){this.rData.hide();this.rBoxes.clear()};Tabs.prototype.show=function(){this.rData.show()};Tabs.prototype.fnPiece=fnPiece;